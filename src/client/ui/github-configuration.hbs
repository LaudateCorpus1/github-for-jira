<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="ap-local-base-url" content="{{localBaseUrl}}" />
    <title>{{title}}</title>
    <link
      rel="stylesheet"
      href="/public/aui/aui-prototyping.css"
      integrity="DTM1Q+8lU7SzJT+FWr0JFisCSZlwfM0GiAKYy7h1s9vIKa/CIh37s9NuOCqIOgK4tmqrjLK4NuWuIPUQNsikHA=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link rel="stylesheet" href="/public/primer/build.css" media="all" />
    <link
      rel="stylesheet"
      href="/public/css/github-configuration.css"
      media="all"
    />
    <link rel="stylesheet" href="/public/css/global.css" media="all" />
    <link rel="stylesheet" href="/public/css/media-queries.css" media="all" />
    <script src="/public/js/jquery.min.js" nonce="{{nonce}}"></script>
  </head>

  <body class="px-3 py-6">
    <input type="hidden" id="_csrf" name="_csrf" value="{{csrfToken}}" />
    <input type="hidden" id="jiraHost" name="jiraHost" value="{{jiraHost}}" />
    <input
      type="hidden"
      id="clientKey"
      name="clientKey"
      value="{{clientKey}}"
    />

    <section class="gitHubConfiguration__logout__container">
      <p class="gitHubConfiguration__logout__account">GitHub Account:
        <span class="gitHubConfiguration__logout__name">{{login}}</span></p>
      <p
        class="gitHubConfiguration__logout__link logout-link"
        target="_blank"
      >Logout</p>
    </section>

    <section class="gitHubConfiguration">
      <div class="headerImage">
        <img
          src="/public/assets/jira-and-github.png"
          alt="Jira and GitHub logos"
        />
      </div>

      <h2 class="f2 text-center text-normal gitHubConfiguration__header">Connect a
        GitHub organization to your Jira site</h2>
      <p class="jiraInstance">{{jiraHost}}</p>

      <div class="Box">
        <div class="gitHubConfiguration__wrapper">
          <div class="gitHubConfiguration__tableHeader">
            <p class="gitHubConfiguration__tableHeader__label">Unconnected organizations with Jira app</p>
            {{#if installations}}
              <p class="gitHubConfiguration__tableHeader__label">Repository access</p>
            {{/if}}
          </div>

          <div class="githubOrgs__table">
            {{#each installations}}
              <div class="githubOrgs__table__row clearfix">
                {{! Organizations }}
                <div class="gitHubConfiguration__orgContent__account org__cell">
                  <img
                    class="gitHubConfiguration__orgContent__avatar"
                    src="{{account.avatar_url}}"
                    alt="Github organization avatar"
                  />
                  <span class="text-bold text-gray-dark">{{account.login}}</a></span>
                </div>

                {{! Repository access }}
                <div class="gitHubConfiguration__orgContent__repoAccess org__cell">
                  <p
                    class="gitHubConfiguration__orgContent__repoSelection"
                  >{{repoAccessType repository_selection}}</p>
                  <p
                    class="gitHubConfiguration__orgContent__numberOfRepos"
                  >{{numberOfRepos}}</p>
                  {{#if admin}}
                    <a href="{{html_url}}">
                      <span
                        class="gitHubConfiguration__orgContent__edit aui-icon aui-icon-small aui-iconfont-new-edit"
                      >
                        Edit
                      </span>
                    </a>
                  {{/if}}
                </div>

                {{! Connect }}
                <div class="gitHubConfiguration__orgContent__connect org__cell">
                  {{#if admin}}
                    <button class="gitHubConfiguration__orgContent__connectBtn--disabled aui-button" aria-disabled="true" disabled>
                      Connect
                    </button>
                     <div class="gitHubConfiguration__notAdminMsg">You are not admin</div>
                    {{else}}
                    {{#if (isNotConnected syncStatus)}}
                      <button
                        class="gitHubConfiguration__orgContent__connectBtn aui-button install-link"
                        data-installation-id="{{id}}"
                        type="submit"
                      >
                        {{connectedStatus syncStatus}}
                      </button>
                    {{else if (inProgressSync syncStatus)}}
                      <div class="gitHubConfiguration__loaderContainer">
                        <aui-spinner size="small"></aui-spinner>
                      </div>
                    {{else}}
                      <p class="gitHubConfiguration__orgContent__connectedMsg">
                        {{connectedStatus syncStatus}}
                      </p>
                    {{/if}}
                  {{/if}}
                </div>

              </div>
            {{/each}}

            {{#unless installations}}
              <p class="gitHubConfiguration__noOrganizations">No GitHub organizations with Jira installed.</p>
            {{/unless}}
          </div>

          <a
            class="gitHubConfiguration__connectNewOrg"
            href="{{info.html_url}}/installations/new"
          >
            <span class="gitHubConfiguration__connectNewOrg__plus">+</span>Install GitHub for Jira on a new organization
          </a>
        </div>
      </div>

    </section>
    <script src="/public/js/github-configuration.js" nonce="{{nonce}}"></script>
    <script
      src="/public/aui/aui-prototyping.js"
      integrity="sha512-DkENIkhNP5r+sfHUC5hhFAzApGNR5HTu1fzymBBhXZma4zytOUQh8qhz5xc3nSbSQfdYI6qdI281YwUNmubEMw=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
      nonce="{{nonce}}"
    ></script>
  </body>

</html>
